<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Moneyard Secure Staking</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        td, th { border: 1px solid #ddd; padding: 8px; text-align: left; }
        .security-footer { margin-top: 30px; font-size: 0.9em; color: #666; }
    </style>
</head>
<body>
    <h1>Moneyard Secure Staking</h1>
    <p>SSL Secured | Insured Assets</p>

    <!-- Auth & Balances Section -->
    <section id="auth-section">
        <h2>Wallet Connection</h2>
        <button onclick="connectWallet()">Connect MetaMask</button>
        <div id="2fa-container" style="display: none; margin-top: 10px;">
            <input type="text" id="2fa-code" placeholder="Enter 2FA Code">
            <button onclick="verify2FA()">Verify</button>
        </div>
        
        <div style="margin-top: 20px;">
            <p>USDT Balance: <strong id="usdt-balance">0.00</strong></p>
            <p>ETH Price: $<strong id="eth-price">0.00</strong></p>
        </div>
    </section>

    <!-- Staking Dashboard -->
    <section>
        <h2>Staking Dashboard</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
            <div>
                <h3>Deposit USDT</h3>
                <input type="number" id="stake-amount" placeholder="Amount (USDT)">
                <button onclick="stakeTokens()" style="margin-top: 10px;">Deposit</button>
            </div>
            <div>
                <h3>Withdraw Funds</h3>
                <input type="number" placeholder="Amount (USDT)">
                <button style="margin-top: 10px;">Withdraw</button>
            </div>
        </div>
    </section>

    <!-- Transaction History -->
    <section>
        <h2>Transaction History</h2>
        <table>
            <tr>
                <th>Date</th>
                <th>Amount</th>
                <th>Type</th>
                <th>Status</th>
            </tr>
            <tr>
                <td>2024-03-15</td>
                <td>$00.00 USDT</td>
                <td>Deposit</td>
                <td>Completed</td>
            </tr>
            <tr>
                <td>2024-03-16</td>
                <td>$.00 USDT</td>
                <td>Reward</td>
                <td>Pending</td>
            </tr>
        </table>
    </section>

    <div class="security-footer">
        <p>Secured with Smart Contracts | Daily Audits | 24/7 Support</p>
        <p>Contact: security@moneyard.com | Contract Address: <span id="contract-address">0x123...abc</span></p>
    </div>

    <script>
        // Web3 Configuration
        let web3;
        let userAddress;
        const CONTRACT_ADDRESS = '0x123...abc'; // Update with actual address
        const CONTRACT_ABI = [...]; // Add your contract ABI
        const USDT_CONTRACT = '0xdAC17F958D2ee523a2206206994597C13D831ec7';

        async function connectWallet() {
            if (window.ethereum) {
                try {
                    web3 = new Web3(window.ethereum);
                    await window.ethereum.enable();
                    const accounts = await web3.eth.getAccounts();
                    userAddress = accounts[0];
                    checkUSDTBalance();
                    initPriceFeed();
                    document.getElementById('2fa-container').style.display = 'block';
                    document.getElementById('contract-address').textContent = CONTRACT_ADDRESS;
                } catch (error) {
                    console.error('Wallet connection failed:', error);
                }
            }
        }

        async function checkUSDTBalance() {
            const contract = new web3.eth.Contract(ERC20_ABI, USDT_CONTRACT);
            const balance = await contract.methods.balanceOf(userAddress).call();
            document.getElementById('usdt-balance').textContent = 
                (balance / 1e6).toFixed(2); // USDT has 6 decimals
        }

        async function stakeTokens() {
            const amount = document.getElementById('stake-amount').value;
            const contract = new web3.eth.Contract(CONTRACT_ABI, CONTRACT_ADDRESS);
            
            await contract.methods.stake(web3.utils.toWei(amount, 'mwei')).send({
                from: userAddress
            });
            alert('Deposit successful!');
        }

        async function initPriceFeed() {
            try {
                const response = await axios.get(
                    'https://api.coingecko.com/api/v3/simple/price?ids=ethereum&vs_currencies=usd'
                );
                document.getElementById('eth-price').textContent = 
                    response.data.ethereum.usd.toFixed(2);
            } catch (error) {
                console.error('Price update failed:', error);
            }
        }

        async function verify2FA() {
            const code = document.getElementById('2fa-code').value;
            // Add actual 2FA verification logic here
            alert('2FA verification submitted (implement backend verification)');
        }
    </script>
</body>
</html>
